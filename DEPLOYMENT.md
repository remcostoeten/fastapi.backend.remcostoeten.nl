# Deployment Instructions

## üöÄ Quick Start

### 1. Set up Railway

```bash
# Login to Railway (interactive)
railway login

# Initialize Railway project
railway init

# Add PostgreSQL service
railway add postgresql

# Set environment variables
railway variables set ENVIRONMENT=production
railway variables set PORT=8000
railway variables set ENABLE_ANALYTICS=true
railway variables set ENABLE_FEEDBACK=true
railway variables set INCREMENT_VIEWS_ONLY_IN_PRODUCTION=true

# Generate and set secret key
railway variables set SECRET_KEY=$(openssl rand -hex 32)
```

### 2. Set up GitHub Secrets

1. **Get Railway Token:**
   - Go to [Railway Dashboard](https://railway.app/dashboard)
   - Account Settings ‚Üí API Tokens
   - Create new token

2. **Add to GitHub:**
   ```bash
   gh secret set RAILWAY_TOKEN --body="your-railway-token-here"
   ```

### 3. Deploy

**Option A: Automated (Recommended)**
```bash
# Push to main/master branch
git checkout main
git merge feature/new-backend
git push origin main

# GitHub Actions will automatically deploy
```

**Option B: Manual**
```bash
# Deploy manually
./scripts/deploy.sh
```

## üìä Monitor Deployment

1. **GitHub Actions:** Check [Actions tab](https://github.com/remcostoeten/backend-new/actions)
2. **Railway Dashboard:** Monitor at [railway.app](https://railway.app)
3. **Health Check:** Visit `https://your-app-url.railway.app/api/v1/health`

## üîß Environment Variables

### Required
- `RAILWAY_TOKEN`: GitHub secret for CI/CD
- `DATABASE_URL`: Auto-provided by Railway PostgreSQL
- `SECRET_KEY`: Auto-generated by setup script

### Optional Features
- `ENABLE_ANALYTICS`: true/false (default: true)
- `ENABLE_FEEDBACK`: true/false (default: true)
- `INCREMENT_VIEWS_ONLY_IN_PRODUCTION`: true/false (default: true)

## üè• Health Check

Test your deployment:
```bash
# Get Railway URL
RAILWAY_URL=$(railway domain --no-trunc | head -n1)

# Health check
curl "$RAILWAY_URL/api/v1/health"
```

Expected response:
```json
{
  "success": true,
  "data": {
    "status": "healthy",
    "timestamp": "2024-01-01T00:00:00.000000",
    "version": "1.0.0",
    "environment": "production"
  }
}
```

## üêõ Troubleshooting

### GitHub Actions Failed
1. Check RAILWAY_TOKEN is set correctly
2. Verify Railway project is connected to GitHub
3. Check Railway project status

### Deployment Health Check Failed
1. Wait 1-2 minutes for Railway to fully deploy
2. Check Railway logs in dashboard
3. Verify all environment variables are set

### Railway Login Issues
1. Use `railway login` (interactive)
2. Or `railway login --token <token>` (non-interactive)

## üìù Next Steps

Once deployed, you can:

1. **Update frontend** to point to new backend:
   ```typescript
   // apps/frontend/src/config/api.config.ts
   const API_ENDPOINTS = {
     local: {
       base: 'http://localhost:8000',
       analytics: 'http://localhost:8000/api',
     },
     production: {
       base: 'https://your-railway-url.railway.app',
       analytics: 'https://your-railway-url.railway.app/api',
     },
   };
   ```

2. **Add more features:**
   - Visitor tracking
   - Pageview analytics
   - Blog view counting
   - Feedback system

3. **Monitor usage** in Railway dashboard and GitHub Actions